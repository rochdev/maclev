version: '2'
services:
  web:
    build: ./maclev-web
    command: ./node_modules/.bin/gulp
    volumes:
      - ./maclev-web/src:/usr/src/app/src
    ports:
      - 80:80
    links:
      - proxy
  proxy:
    build: ./maclev-proxy
  api:
    build: ./maclev-api
    command: nodemon -L .
    volumes:
      - ./maclev-api/lib:/usr/src/app/lib
      - ./maclev-api/migrations:/usr/src/app/migrations
    env_file:
      - ./postgres.env
  scheduler:
    build: ./maclev-scheduler
    command: nodemon -L .
    volumes:
      - ./maclev-scheduler/index.js:/usr/src/app/index.js
  postgres:
    ports:
      - 5432:5432
    env_file:
      - ./postgres.env
  queue-ui:
    build: ./maclev-queue-ui
    environment:
      - REDIS_URL=redis://queue:6379
